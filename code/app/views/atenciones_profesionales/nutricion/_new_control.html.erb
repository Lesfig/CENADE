<%es_doctor = (current_user.empleado_type=='Doctor') ? true : false%>
<%= simple_form_for control, html: {class: ''}, remote: true do |cont|%>
  <%= cont.hidden_field(:paciente_id, value: paciente_id) %>
  <%= cont.hidden_field(:area_id, value: area_id) %>
  <div class="row">
    <%unless es_doctor%>
      <%= cont.input :doctor_id, collection: doctores.collect { |a| [a.full_name, a.id] }, label: '* Prof. de la Salud', wrapper_html: { class: 'col-md-8' }, input_html:  { class: 'required select2'} %>
    <%else%>
      <%= data('Profesional de la Salud',current_user.empleado.persona_full_name,'col-md-8') %>
      <%= hidden_field_tag(:doctor_id, current_user.empleado.id) %>
    <%end%>

    <%= cont.input :fecha, as: :string, label: '* Fecha', wrapper_html: { class: 'col-md-4'}, input_html: { class: 'datepicker dateLessSystemDate required', maxLength: Domain::FECHA, value:Formatter.format_date(control.fecha.blank? ? Date.today : control.fecha)} %>
  </div>

  <div class="row">
    <%= cont.input :tratamiento, as: :text, label: 'Tratamiento', wrapper_html: { class: 'col-md-12'}, input_html: { maxLength: Domain::DESC300, rows: "3"} %>
  </div>

  <div class="row">
   <%= cont.input :observaciones, as: :text, label: 'Observaciones', wrapper_html: { class: 'col-md-12'}, input_html: { maxLength: Domain::DESC300, rows: "2"} %>
  </div>

  <div class="form-button">
    <%= cont.submit 'Guardar', class: 'btn btn-custom'%>
  </div>
<% end %>

<script type="text/javascript">
  <%unless es_doctor%>
    //Setea el doctor logueado o el doctor seleccionado en el sidebar
    $('#control_doctor_id').val($('#doctor_id').val());
    APP.initSelect2({element: '#control_doctor_id', placeholder: 'Seleccione un Profesional'});
  <% end %>
  APP.initDatepicker();
  $('#new_control').validate();
</script>